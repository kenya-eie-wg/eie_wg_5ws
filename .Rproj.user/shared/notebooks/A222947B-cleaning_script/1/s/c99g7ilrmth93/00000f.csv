"0",""
"0",""
"0","read_5ws <- function(file) {"
"0","  "
"0","  read_excel(file, "
"0","             sheet = ""5W_Data_Entry"", "
"0","             skip = 2, "
"0","             col_types = c("
"0","               ""text"", ""text"", ""text"", ""text"", ""text"", ""text"", "
"0","               ""text"", ""text"", ""text"", ""text"", ""text"", ""text"", "
"0","               ""date"", ""date"", "
"0","               ""text"", "
"0","               ""numeric"", ""numeric"", ""numeric"", ""numeric"", "
"0","               ""text"", ""numeric"", ""text"""
"0","             )) %>% "
"0","    setNames(names_5ws) %>% "
"0","    mutate(source = file_list[i]) %>%"
"0","    # Doing this here, but you can always move this to the end"
"0","    # But this is the assumption that these lists are correct"
"0","    mutate( "
"0","      names_numbers_schools = case_when("
"0","        names_numbers_schools == ""All the Juniour Secondary Schools (JSS) in Kalobeyei Settlement"" ~"
"0","        ""Kalobeyei Settlement, Friends, Joy, Morningstar, Future and Bright Junior Secondary Secondary schools."","
"0","        names_numbers_schools == ""All the main Secondary Schools in Kalobeyei Settlement"" ~ "
"0","        ""Kalobeyei Settlement, Friends, Joy, Morningstar, Future and Bright Junior Secondary Secondary schools."", "
"0","        TRUE ~ names_numbers_schools)) %>% "
"0","    mutate("
"0","      schools = case_when("
"0","      activity == ""Provision of school meals to learners in the 8 primary schools and 7 pre-primary schools in Kalobeyei Settlement."" ~ 15,"
"0","      names_numbers_schools == ""22 refugee schools and 11 host community schools"" ~ 33,"
"0","      str_detect(names_numbers_schools, ""\n"") ~ str_count(names_numbers_schools, ""\n"") + 1,"
"0","      str_detect(names_numbers_schools, ""\\,"") ~ str_count(names_numbers_schools, ""\\,|and|&"") + 1, "
"0","      str_detect(names_numbers_schools, ""and"") ~ str_count(names_numbers_schools, ""and"") + 1,"
"0","      str_detect(names_numbers_schools, ""\\;"") ~ str_count(names_numbers_schools, ""\\;"") + 1, "
"0","      !is.na(names_numbers_schools) ~ parse_number(names_numbers_schools), "
"0","      TRUE ~ NA_integer_), "
"0","      schools = ifelse(!is.na(names_numbers_schools) & is.na(schools), 1, schools)"
"0","      ) %>%"
"0","    replace_with_na(replace = list(names_numbers_schools = ""N/A"")) %>% "
"0","    filter(!is.na(month) & !is.na(lead_organisation) & !is.na(indicator)) %>% "
"0","    mutate(county = recode(county, "
"0","                            ""Tana_River"" = ""Tana River"", "
"0","                            ""Homa_Bay"" = ""Homa Bay"", "
"0","                            ""Home Bay"" = ""Homa Bay"", "
"0","                            ""West_Pokot"" = ""West Pokot"", "
"0","                            ""Taita_Taveta"" = ""Taita Taveta"")) %>% "
"0","    left_join(locations %>% "
"0","                distinct(adm1_en, adm1_pcode),"
"0","               by = c(""county"" = ""adm1_en"")) %>% "
"0","  mutate(indicator = case_when("
"0","    str_detect(indicator, ""in drought affected areas"") ~ paste0(""indicator 1 "", indicator), "
"0","    str_detect(indicator, ""feeding programmes"") ~ paste0(""indicator 2 "", indicator), "
"0","    str_detect(indicator, ""teaching materials"") ~ paste0(""indicator 3 "", indicator), "
"0","    str_detect(indicator, ""hygiene"") ~ paste0(""indicator 4 "", indicator), "
"0","    str_detect(indicator, ""educators trained on resilience"") ~ paste0(""indicator 5 "", indicator), "
"0","    str_detect(indicator, ""youth benefiting from resilience"") ~ paste0(""indicator 6 "", indicator), "
"0","    TRUE ~ indicator"
"0","  )) %>% "
"0","    mutate(month = fct_relevel(month, c(""January"", ""February"", ""March"", ""April"", "
"0","                                        ""May"", ""June"", ""July"", ""August"", "
"0","                                        ""September"", ""October"", ""November"", ""December""))) %>% "
"0","  mutate(implementing_partner = case_when("
"0","    str_detect(implementing_partner, ""AVSI"") ~ ""AVSI Foundation"", "
"0","    implementing_partner == ""Action for sustainable change"" ~ ""Action for Sustainable Change"", "
"0","    str_detect(implementing_partner, ""FCA|FINN|Finn"") ~ ""Finn Church Aid"", "
"0","    str_detect(implementing_partner, ""LIFESKILL|Life skills|Lifeskills|LifeSkills|LISP"") ~ ""Lifeskill Promoters"", "
"0","    implementing_partner == ""Missionary Sistrs of the catechism"" ~ ""Missionary Sisters of the Catechism"", "
"0","    str_detect(implementing_partner, ""NRC|NORWEGIAN"") ~ ""Norwegian Refugee Council"", "
"0","    str_detect(implementing_partner, ""SC|SCI|Save the Children"") ~ ""Save the Children"", "
"0","    str_detect(implementing_partner, ""World Vision"") ~ ""World Vision Kenya"", "
"0","    TRUE ~ implementing_partner"
"0","  ))%>% "
"0","  mutate(indicator_short = case_when("
"0","    indicator == ""indicator 1 # of children and youth accessing ECD spaces/schools in drought affected areas"" ~ "
"0","      ""1. Access ECD spaces/schools"", "
"0","    indicator == ""indicator 2 # of schools/ECD spaces with feeding programmes"" ~ "
"0","      ""2. Feeding programmes"", "
"0","    # Not sure what's wrong with the text of this indicator"
"0","    str_detect(indicator, ""3"") ~ ""3. Teaching materials"", "
"0","    indicator == ""indicator 4 # of schools with adequate quantites of safe water for drinking and personal hygiene"" ~ "
"0","      ""4. Safe water, personal hygiene"", "
"0","    indicator == ""indicator 5 # of teachers / educators trained on resilience enhancing programmes (MHPSS, DRR & Life Skills, etc)"" ~ "
"0","      ""5. Educators resilience enhancing"", "
"0","    indicator == ""indicator 6 # of children and youth benefiting from resilience enhancing programmes (MHPSS, DRR & Life Skills, etc)"" ~ "
"0","      ""6. Children resilience enhancing"""
"0","  )) %>% "
"0","    filter(!is.na(county))"
"0","    "
"0","  } "
"0",""
