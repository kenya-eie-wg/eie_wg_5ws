"0",""
"0",""
"0","read_5ws <- function(file) {"
"0","  "
"0","  read_excel(file, "
"0","             sheet = ""5W_Data_Entry"", "
"0","             skip = 2, "
"0","             col_types = c("
"0","               ""text"", ""text"", ""text"", ""text"", ""text"", ""text"", "
"0","               ""text"", ""text"", ""text"", ""text"", ""text"", ""text"", "
"0","               ""date"", ""date"", "
"0","               ""text"", "
"0","               ""numeric"", ""numeric"", ""numeric"", ""numeric"", "
"0","               ""text"", ""numeric"", ""text"""
"0","             )) %>% "
"0","    setNames(names_5ws) %>% "
"0","    mutate(source = file_list[i]) %>%"
"0","    # Doing this here, but you can always move this to the end"
"0","    # But this is the assumption that these lists are correct"
"0","    mutate( "
"0","      names_numbers_schools = case_when("
"0","        names_numbers_schools == ""All the Juniour Secondary Schools (JSS) in Kalobeyei Settlement"" ~"
"0","        ""Kalobeyei Settlement, Friends, Joy, Morningstar, Future and Bright Junior Secondary Secondary schools."","
"0","        names_numbers_schools == ""All the main Secondary Schools in Kalobeyei Settlement"" ~ "
"0","        ""Kalobeyei Settlement, Friends, Joy, Morningstar, Future and Bright Junior Secondary Secondary schools."", "
"0","        TRUE ~ names_numbers_schools)) %>% "
"0","    mutate("
"0","      schools = case_when("
"0","      activity == ""Provision of school meals to learners in the 8 primary schools and 7 pre-primary schools in Kalobeyei Settlement."" ~ 15,"
"0","      names_numbers_schools == ""22 refugee schools and 11 host community schools"" ~ 33,"
"0","      comments == ""37 schools supported with 115 handwashing kits"" ~ 37,"
"0","      str_detect(names_numbers_schools, ""\n"") ~ str_count(names_numbers_schools, ""\n"") + 1,"
"0","      str_detect(names_numbers_schools, ""\\,"") ~ str_count(names_numbers_schools, ""\\,|and|&"") + 1, "
"0","      str_detect(names_numbers_schools, ""and"") ~ str_count(names_numbers_schools, ""and"") + 1,"
"0","      str_detect(names_numbers_schools, ""\\;"") ~ str_count(names_numbers_schools, ""\\;"") + 1, "
"0","      !is.na(names_numbers_schools) ~ parse_number(names_numbers_schools), "
"0","      TRUE ~ NA_integer_), "
"0","      schools = ifelse(!is.na(names_numbers_schools) & is.na(schools), 1, schools)"
"0","      ) %>%"
"0","    replace_with_na(replace = list(names_numbers_schools = ""N/A"")) %>% "
"0","    filter(!is.na(month) & !is.na(lead_organisation) & !is.na(indicator)) %>% "
"0","    mutate(county = recode(county, "
"0","                            ""Tana_River"" = ""Tana River"", "
"0","                            ""Homa_Bay"" = ""Homa Bay"", "
"0","                            ""Home Bay"" = ""Homa Bay"", "
"0","                            ""West_Pokot"" = ""West Pokot"", "
"0","                            ""Taita_Taveta"" = ""Taita Taveta"")) %>% "
"0","    left_join(locations %>% "
"0","                distinct(adm1_en, adm1_pcode),"
"0","               by = c(""county"" = ""adm1_en"")) %>% "
"0","  mutate(indicator = case_when("
"0","    str_detect(indicator, ""in drought affected areas"") ~ paste0(""indicator 1 "", indicator), "
"0","    str_detect(indicator, ""feeding programmes"") ~ paste0(""indicator 2 "", indicator), "
"0","    str_detect(indicator, ""teaching materials"") ~ paste0(""indicator 3 "", indicator), "
"0","    str_detect(indicator, ""hygiene"") ~ paste0(""indicator 4 "", indicator), "
"0","    str_detect(indicator, ""educators trained on resilience"") ~ paste0(""indicator 5 "", indicator), "
"0","    str_detect(indicator, ""youth benefiting from resilience"") ~ paste0(""indicator 6 "", indicator), "
"0","    TRUE ~ indicator"
"0","  )) %>% "
"0","    mutate(month = fct_relevel(month, c(""January"", ""February"", ""March"", ""April"", "
"0","                                        ""May"", ""June"", ""July"", ""August"", "
"0","                                        ""September"", ""October"", ""November"", ""December""))) %>%"
"0","    mutate_at(vars(implementing_partner, lead_organisation), ~ str_trim(str_squish(.))) %>% "
"0","    mutate_at(vars(implementing_partner, lead_organisation), ~"
"0","                case_when("
"0","                  str_detect(., ""AVSI"") ~ ""AVSI Foundation"","
"0","                  str_detect(., ""Action for sustainable change|Action for Sustainable change"") ~ "
"0","                    ""Action for Sustainable Change"","
"0","                  str_detect(., ""FCA|FINN|Finn"") ~ ""Finn Church Aid"","
"0","                  str_detect("
"0","                    ., ""LIFESKILL|Life skills|Lifeskills|LifeSkills|LISP|LISFESKILLS PROMOTERS|LIFESKIILS PROMOTERS"") ~"
"0","                    ""Lifeskills Promoters"","
"0","                  str_detect(., ""ChildFund|Childfund"") ~ ""ChildFund Kenya"", "
"0","                  str_detect(., ""Missionary Sistrs of the catechism|Missionary sisters of the catechism"") "
"0","                  ~ ""Missionary Sisters of the Catechism"","
"0","                  str_detect(., ""NRC|NORWEGIAN"") ~ ""Norwegian Refugee Council"","
"0","                  str_detect(., ""SCI|Save the Children"") ~ ""Save the Children"","
"0","                  str_detect(., ""World Vision|World vision|WVK BAMBA AP"") ~ ""World Vision Kenya"","
"0","                  str_detect(., ""Nawiri Children Program"") ~ ""Nawiri Children Development Program"","
"0","                  str_detect(., ""ERIKs development Partner"") ~ ""ERIKs Development Partner"","
"0","                  str_detect(., ""Servants of the poor"") ~ ""Servants of the Poor"","
"0","                  str_detect(., ""Evangelizing sisters of mary|ESM"") ~ ""Evangelizing Sisters of Mary"","
"0","                  str_detect(., ""Voluntary Service Overseas|VSO"") ~ ""Voluntary Service Overseas"", "
"0","                  str_detect(., ""Homa Bay Counties"") ~ ""Homa Bay County"", "
"0","                  str_detect(., ""WERK"") ~ ""Women Educational Researchers of Kenya"","
"0","                  str_detect(., ""Women Educational Researchers of Kenya,"") ~ ""Women Educational Researchers of Kenya"","
"0","                  str_detect(., ""The Girl Child Network \\(GCN\\)"") ~ ""The Girl Child Network"", "
"0","                  str_detect(., ""FHK|FH Kenya"") ~ ""Food for the Hungry"","
"0","                  str_detect(., ""Futebol da Forcaa"") ~ ""Futebol da Forcaa"", "
"0","                  str_detect(., ""Edukans and SHERP Samburu"") ~ ""Edukans"", "
"0","                  str_detect(., ""Feed The Children"") ~ ""Feed the Children"", "
"0","                  . == ""MOE"" ~ ""Ministry of Education"", "
"0","                  . == ""CDE Wajir"" ~ ""County Director of Education Wajir"","
"0","                  . == ""CDE Mandera"" ~ ""County Director of Education Mandera"", "
"0","                  . == ""CDE Marsabit""  ~ ""County Director of Education Marsabit"", "
"0","                  . == ""Girl Child Network"" ~ ""The Girl Child Network"", "
"0","                  . == ""SC"" ~ ""Save the Children"","
"0","                  TRUE ~ ."
"0","                ))%>% "
"0","    # Think about how you want to resolve the disaggregation issues "
"0","    mutate(indicator = ifelse("
"0","      !is.na(boys) & str_detect(activity, ""Training of children""),"
"0","        ""indicator 6 # of children and youth benefiting from resilience enhancing programmes (MHPSS, DRR & Life Skills, etc)"", indicator)) %>%"
"0","     mutate(indicator_short = case_when("
"0","    indicator == ""indicator 1 # of children and youth accessing ECD spaces/schools in drought affected areas"" ~ "
"0","      ""1. Access ECD spaces/schools"", "
"0","    indicator == ""indicator 2 # of schools/ECD spaces with feeding programmes"" ~ "
"0","      ""2. Feeding programmes"", "
"0","    # Not sure what's wrong with the text of this indicator"
"0","    str_detect(indicator, ""3"") ~ ""3. Teaching materials"", "
"0","    indicator == ""indicator 4 # of schools with adequate quantites of safe water for drinking and personal hygiene"" ~ "
"0","      ""4. Safe water, personal hygiene"", "
"0","    indicator == ""indicator 5 # of teachers / educators trained on resilience enhancing programmes (MHPSS, DRR & Life Skills, etc)"" ~ "
"0","      ""5. Educators resilience enhancing"", "
"0","    indicator == ""indicator 6 # of children and youth benefiting from resilience enhancing programmes (MHPSS, DRR & Life Skills, etc)"" ~ "
"0","      ""6. Children resilience enhancing"""
"0","  )) %>% "
"0","    filter(!is.na(county) & total_reached > 0) %>% "
"0","    mutate(sector_reached = ifelse(str_detect(indicator_short, ""1|2|5|6""), "
"0","                                 total_reached, "
"0","                                 0)) %>% "
"0","    mutate(source = str_remove(source, "
"0","                             ""C:/Users/seanywng/Documents/R/eie_wg_5ws/data/5Ws_2023/"")) %>% "
"0","    filter(!is.na(indicator)) %>% "
"0","    mutate(implementing_partner = ifelse(is.na(implementing_partner), lead_organisation, implementing_partner))"
"0","    "
"0","  } "
"0",""
