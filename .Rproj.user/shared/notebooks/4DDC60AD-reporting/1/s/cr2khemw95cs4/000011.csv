"0","sum_stats <- eie %>%  "
"0","  summarise(partners = n_distinct(implementing_partner), "
"0","            counties = n_distinct(county), "
"0","            reached = sum(sector_reached, na.rm = TRUE), "
"0","            men = sum(men[activity_status == ""Completed""], na.rm = TRUE), "
"0","            women = sum(women[activity_status == ""Completed""], na.rm = TRUE), "
"0","            boys = sum(boys[activity_status == ""Completed""], na.rm = TRUE), "
"0","            girls = sum(girls[activity_status == ""Completed""], na.rm = TRUE), "
"0","            reached_1256 = sum(total_reached[str_detect(indicator_short, ""1|2|5|6"") & "
"0","                                               activity_status == ""Completed""], na.rm = TRUE), "
"0","            latest_reached = sum(total_reached[str_detect(indicator_short, ""1|2|5|6"") & "
"0","                                               activity_status == ""Completed""& "
"0","                                                 month %in% report_month], "
"0","                                 na.rm = TRUE))"
"0",""
"0",""
"0",""
"0","eie %>% "
"0","  filter(activity_status == ""Completed"") %>% "
"0","  mutate(latest_reached = ifelse(month %in% report_month, total_reached, NA_integer_)) %>% "
"0","  group_by(indicator_short) %>% "
"0","  summarise(partners = n_distinct(implementing_partner), "
"0","            counties = n_distinct(adm1_pcode),   "
"0","            latest_reached = sum(latest_reached, na.rm = TRUE), "
"0","            total_reached = sum(total_reached, na.rm = TRUE)) %>% "
"0","  adorn_totals(""row"",,,, latest_reached, total_reached) %>% "
"0","  mutate(partners = ifelse(indicator_short == ""Total"", sum_stats$partners, partners), "
"0","         counties = ifelse(indicator_short == ""Total"", sum_stats$counties, counties), "
"0","         total_reached = ifelse(indicator_short == ""Total"", "
"0","                                sum_stats$reached_1256, "
"0","                                total_reached), "
"0","         latest_reached = ifelse(indicator_short == ""Total"", "
"0","                                 sum_stats$latest_reached, "
"0","                                 latest_reached)) %>% "
"0","  left_join(targets %>% "
"0","              filter(target_unit == ""people"") %>%"
"0","              group_by(indicator_short) %>%"
"0","              summarise(target = sum(county_target)), "
"0","            by = ""indicator_short"") %>% "
"0","  mutate(target = ifelse(indicator_short == ""Total"", "
"0","                         targets %>% distinct(county, county_overall_target) %>% {sum(.$county_overall_target)}, "
"0","                         target)) %>% "
"0","  mutate(pc = round(total_reached / target * 100, digits = 2)) %>%"
"0","  select(indicator = indicator_short, partners, counties, "
"0","         latest_reached, total_reached, target, `%target` = pc) %>%"
"0","  select_all(~ gsub(""latest"", "
"0","                    report_month, .)) %>%"
"0","  select_all(~ str_to_title(.)) %>% "
"0","  flextable() %>% "
"0","  theme_zebra() %>% "
"0","  set_caption(paste0(""Summary statistics for EIE 5Ws reporting, "", report_date)) %>% "
"0","  set_table_properties(layout = ""autofit"", width = .99) %>% "
"0","  fontsize(i = 1:6, j = 1, size = 9) %>% "
"0","  fontsize(size = 9, part = ""header"") %>% "
"0","  footnote(i = 1, j = 4, part = ""header"", ref_symbols = ""1"", "
"0","           as_paragraph(""Distinct number of schools not available as full list of schools is not reported"")) %>% "
"0","  footnote(i = 7, j = 5:6, ref_symbols = ""2"", "
"0","           as_paragraph(""Only the sum of indicators 1, 2, 5 and 6""))"
