"0","targets_range <- targets %>% "
"0","  filter(target_unit == ""people"") %>% "
"0","  group_by(indicator_short, county) %>% "
"0","  summarise(target = sum(county_target, na.rm = TRUE)) %>% "
"0","  pivot_wider(names_from = indicator_short, values_from = target) %>% "
"0","  setNames(c(""county"", ""indicator1"", ""indicator2"", ""indicator3"", ""indicator4"", "
"0","             ""indicator5"", ""indicator6""))"
"0",""
"0","indicator_map <- function(tbl, indicator_number, plot_option) {"
"0","  "
"0","  plot_option <- enquo(plot_option)"
"0","  indicator_number <- enquo(indicator_number)"
"0","  "
"0","  tbl %>% "
"0","    filter(str_detect(indicator_short, !!indicator_number)) %>% "
"0","    group_by(indicator_short, county) %>% "
"0","    summarise(beneficiaries = sum(total_reached, na.rm = TRUE)) %>% "
"0","    full_join(targets %>% "
"0","                filter(str_detect(indicator_short, !!indicator_number)) %>%"
"0","                filter(target_unit %in% c(""people"")) %>% "
"0","                select(county, indicator_short, county_target), "
"0","              by = c(""county"", ""indicator_short"")) %>% "
"0","    replace_na(list(county_target = 0, "
"0","                    beneficiaries = 0)) %>% "
"0","    filter(beneficiaries > 0 | county_target > 0)  %>% "
"0","    mutate(pc = ifelse(county_target > 0, beneficiaries / county_target, 0), "
"0","           county = fct_reorder(county, beneficiaries)) %>% "
"0","    naniar::replace_with_na(list(beneficiaries = 0)) %>% "
"0","    left_join(locations %>% "
"0","                distinct(county = adm1_en, adm1_pcode), "
"0","              by = ""county"") %>% "
"0","    right_join(pcode1_shape, by = c(""adm1_pcode"")) %>%"
"0","    st_as_sf() %>% "
"0","    ggplot() + "
"0","    geom_sf(size = .01, colour = ""grey70"", "
"0","            aes(fill = !!plot_option)) + "
"0","    geom_sf_text(aes(label = comma(!!plot_option)),"
"0","                 colour = ""grey45"","
"0","                 size = 2.5) + "
"0","    scale_fill_viridis_c(labels = comma, "
"0","                         na.value = ""grey80"") + "
"0","    theme_void() + "
"0","    theme(plot.title = element_text(hjust = .5))"
"0","    "
"0","}"
"0",""
