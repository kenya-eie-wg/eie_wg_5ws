"0","check <- combined %>% "
"0","  mutate(sub_indicator_alt = str_sub(sub_indicator, start = 1L, end = 15L)) %>%"
"0","  mutate(sub_indicator_alt = str_replace_all(sub_indicator_alt, ""all_"", ""all""),"
"0","         sub_indicator_alt = str_replace_all(sub_indicator_alt, ""cwd_"", ""cwd""),"
"0","         sub_indicator_alt = str_replace_all(sub_indicator_alt, ""host"", ""host_community""),"
"0","         sub_indicator_alt = str_replace_all(sub_indicator_alt, ""refu"", ""refugees""),"
"0","         sub_indicator_alt = str_replace_all(sub_indicator_alt, ""narr"", ""narrative""), "
"0","         sub_indicator_alt = ifelse(sub_indicator %in% c(""new_classrooms"","
"0","                                                         ""indicator2_new_latrines"", "
"0","                                                         ""indicator2_rehabilitated_classrooms"", "
"0","                                                         ""indicator2_rehabiltated_latrines""), "
"0","                                    sub_indicator, sub_indicator_alt)) %>%"
"0","  group_by(month, county, sub_indicator_alt, sex_modifier) %>% "
"0","  summarise(value = sum(value, na.rm = TRUE)) %>% "
"0","  pivot_wider(names_from = sex_modifier, values_from = value) %>% "
"0","  select(-`NA`) %>% "
"0","  mutate(total = ifelse(female + male > total, female + male, total)) %>% "
"0","  pivot_longer(cols = c(female, male, total),"
"0","               names_to = ""sex_modifier"", "
"0","               values_to = ""check_value"") %>% "
"0","  mutate(key = paste0(month, county, sub_indicator_alt, sex_modifier)) %>% "
"0","  ungroup()"
"0","  "
"0","# Write over the old dataset "
"0",""
"0","combined <- combined %>% "
"0","  mutate(sub_indicator_alt = str_sub(sub_indicator, start = 1L, end = 15L)) %>%"
"0","  mutate(sub_indicator_alt = str_replace_all(sub_indicator_alt, ""all_"", ""all""),"
"0","         sub_indicator_alt = str_replace_all(sub_indicator_alt, ""cwd_"", ""cwd""),"
"0","         sub_indicator_alt = str_replace_all(sub_indicator_alt, ""host"", ""host_community""),"
"0","         sub_indicator_alt = str_replace_all(sub_indicator_alt, ""refu"", ""refugees""),"
"0","         sub_indicator_alt = str_replace_all(sub_indicator_alt, ""narr"", ""narrative""), "
"0","         sub_indicator_alt = ifelse(sub_indicator %in% c(""new_classrooms"","
"0","                                                         ""indicator2_new_latrines"", "
"0","                                                         ""indicator2_rehabilitated_classrooms"", "
"0","                                                         ""indicator2_rehabiltated_latrines""), "
"0","                                    sub_indicator, sub_indicator_alt)) %>%"
"0","  mutate(key = paste0(month, county, sub_indicator_alt, sex_modifier)) %>% "
"0","  left_join(check %>% select(key, check_value), "
"0","            by = ""key"") %>% "
"0","  mutate(value = case_when(str_detect(sub_indicator, ""narrative"") ~ value, "
"0","                           value != check_value ~ check_value, "
"0","                           TRUE ~ value)) %>% "
"0","  select(-key, -sub_indicator_alt, -key)"
