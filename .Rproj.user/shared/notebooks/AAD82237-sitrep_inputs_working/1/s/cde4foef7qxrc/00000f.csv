"0",""
"0","clean_messy_table_alt <- function(tbl) {"
"0","  tbl %>% "
"0","    setNames(messy) %>% "
"0","    slice(10:248) %>% "
"0","    mutate(county = word(month, 1)) %>%"
"0","    naniar::replace_with_na(list(county = ""July"", "
"0","                                 county = ""NA"", "
"0","                                 month = ""NA"")) %>% "
"0","    fill(county) %>% "
"0","    mutate(county = case_when(str_detect(county, ""West"") ~ ""West Pokot"", "
"0","                              str_detect(county, ""Homa"") ~ ""Homa Bay"", "
"0","                              str_detect(county, ""Taita"") ~ ""Taita Taveta"","
"0","                              str_detect(county, ""Tana"") ~ ""Tana River"", "
"0","                              str_detect(county, ""Tharaka"") ~ ""Tharaka Nithi"", "
"0","                              TRUE ~ county)) %>% "
"0","    mutate(month = stri_extract_last_words(month)) %>%"
"0","    filter(!is.na(month)) %>% "
"0","    select(-contains(""x"")) %>%"
"0","  mutate_at(vars(-matches(""narrative|month|county"")), ~as.numeric(.)) %>% "
"0","  mutate_at(vars(-matches(""narrative|month|county"")), ~ ifelse(is.na(.), 0, .)) %>%"
"0","    mutate(indicator3_all_boys = ifelse(indicator3_host_community_boys > indicator3_all_boys, "
"0","                                      indicator3_host_community_boys, "
"0","                                      indicator3_all_girls), "
"0","         indicator3_all_girls = ifelse(indicator3_host_community_girls > indicator3_all_girls, "
"0","                                       indicator3_host_community_girls, "
"0","                                       indicator3_all_girls)) %>% "
"0","      mutate(indicator1_host_community_total_children = indicator1_host_community_boys +"
"0","           indicator1_host_community_girls, "
"0","         indicator1_idps_total_children = indicator1_idps_boys + indicator1_idps_girls, "
"0","         indicator1_refugees_total_children = indicator1_refugees_boys + indicator1_refugees_girls, "
"0","         indicator1_cwd_total_children = indicator1_cwd_boys + indicator1_cwd_girls, "
"0","         indicator2_host_community_total_children = indicator2_host_community_boys +"
"0","           indicator2_host_community_girls, "
"0","         indicator2_idps_total_children = indicator2_idps_boys + indicator2_idps_girls, "
"0","         indicator2_refugees_total_children = indicator2_refugees_boys + indicator2_refugees_girls, "
"0","         indicator2_cwd_total_children = indicator2_cwd_boys + indicator2_cwd_girls, "
"0","         indicator3_host_community_total_children = indicator3_host_community_boys +"
"0","           indicator3_host_community_girls, "
"0","         indicator3_idps_total_children = indicator3_idps_boys + indicator3_idps_girls, "
"0","         indicator3_refugees_total_children = indicator3_refugees_boys + indicator3_refugees_girls, "
"0","         indicator3_cwd_total_children = indicator3_cwd_boys + indicator3_cwd_girls, "
"0","         indicator4_host_community_total_adults = indicator4_host_community_female + "
"0","           indicator4_host_community_male, "
"0","         indicator4_idps_total_adults = indicator4_idps_female + indicator4_idps_male, "
"0","         indicator4_refugees_total_adults = indicator4_refugees_male + indicator4_refugees_female, "
"0","         indicator5_host_community_total_adults = indicator5_host_community_female + "
"0","           indicator5_host_community_male, "
"0","         indicator5_idps_total_adults = indicator5_idps_female + indicator5_idps_male, "
"0","         indicator5_refugees_total_adults = indicator5_refugees_male + indicator5_refugees_female,"
"0","         indicator7_host_community_total_children = indicator7_host_community_boys +"
"0","           indicator7_host_community_girls, "
"0","         indicator7_idps_total_children = indicator7_idps_boys + indicator7_idps_girls, "
"0","         indicator7_refugees_total_children = indicator7_refugees_boys + indicator7_refugees_girls, "
"0","         indicator7_cwd_total_children = indicator7_cwd_boys + indicator7_cwd_girls) %>% "
"0","    "
"0","  mutate(indicator1_all_girls = indicator1_host_community_girls + indicator1_idps_girls +"
"0","           indicator1_refugees_girls, "
"0","         indicator1_all_boys = indicator1_host_community_boys + indicator1_idps_boys + "
"0","           indicator1_refugees_boys, "
"0","         indicator1_all_total_children = indicator1_all_boys + indicator1_all_girls, "
"0","         indicator2_all_boys = indicator2_host_community_boys + indicator2_idps_boys + "
"0","           indicator2_refugees_boys, "
"0","         indicator2_all_girls = indicator2_host_community_girls + indicator2_idps_girls +"
"0","           indicator2_refugees_girls,"
"0","         indicator2_all_total_children = indicator2_all_boys + indicator2_all_girls, "
"0","         indicator3_all_boys = indicator3_host_community_boys + indicator3_idps_boys + "
"0","           indicator3_refugees_boys,"
"0","         indicator3_all_girls = indicator3_host_community_girls + indicator3_idps_girls +"
"0","           indicator3_refugees_girls, "
"0","         indicator3_all_total_children = indicator3_all_boys + indicator3_all_girls, "
"0","         indicator4_all_female = indicator4_host_community_female + indicator4_idps_female +"
"0","           indicator4_refugees_female, "
"0","         indicator4_all_male = indicator4_host_community_male + indicator4_idps_male + "
"0","           indicator4_refugees_male, "
"0","         indicator4_all_total_adults = indicator4_all_female + indicator4_all_male, "
"0","         indicator5_all_female = indicator5_host_community_female + indicator5_idps_female +"
"0","           indicator5_refugees_female, "
"0","         indicator5_all_male = indicator5_host_community_male + indicator5_idps_male + "
"0","           indicator5_refugees_male, "
"0","         indicator5_all_total_adults = indicator5_all_female + indicator5_all_male,"
"0","         indicator7_all_girls = indicator7_host_community_girls + indicator7_idps_girls +"
"0","           indicator7_refugees_girls, "
"0","         indicator7_all_boys = indicator7_host_community_boys + indicator7_idps_boys + "
"0","           indicator7_refugees_boys, "
"0","         indicator7_all_total_children = indicator7_all_boys + indicator7_all_girls, "
"0","         indicator6_all_total_adults = indicator6_all_female + indicator6_all_male) %>% "
"0","    filter(month != ""Total"")  %>%"
"0","    group_by(county) %>%"
"0","    group_modify(~bind_rows(., "
"0","                            summarise(., across(where(is.numeric), sum)))) %>% "
"0","    ungroup() %>% "
"0","    mutate(month = ifelse(is.na(month), ""Total"", month)) %>% "
"0","     mutate_at(vars(everything()), ~ as.character(.)) %>% "
"0","       pivot_longer(cols = indicator1_all_total_children:indicator7_narrative, "
"0","                   names_to = ""indicator"", "
"0","                   values_to = ""value"") %>%"
"0","    mutate(month = fct_relevel(month, c(""January"", ""February"", ""March"", "
"0","                                             ""April"", ""May"", ""June"", ""July"")),"
"0","           char_value = as.character(value),"
"0","           value = as.numeric(value))"
"0","}"
"0","  "
