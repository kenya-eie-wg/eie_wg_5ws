"0",""
"0",""
"0","read_5ws_v1 <- function(file) {"
"0","  "
"0","  read_excel(file, "
"0","             sheet = ""5W_Data_Entry"", "
"0","             skip = 2, "
"0","             col_types = c("
"0","               ""text"", ""text"", ""text"", ""text"", ""text"", ""text"", "
"0","               ""text"", ""text"", ""text"", ""text"", ""text"", ""text"", "
"0","               ""date"", ""date"", "
"0","               ""text"", "
"0","               ""numeric"", ""numeric"", ""numeric"", ""numeric"", "
"0","               ""text"", ""numeric"", ""text"""
"0","             )) %>% "
"0","    setNames(v1_names_5ws) %>% "
"0","    mutate(source = file_list_v1[i]) %>%"
"0","    # Doing this here, but you can always move this to the end"
"0","    # But this is the assumption that these lists are correct"
"0","    mutate( "
"0","      names_numbers_schools = case_when("
"0","        names_numbers_schools == ""All the Juniour Secondary Schools (JSS) in Kalobeyei Settlement"" ~"
"0","        ""Kalobeyei Settlement, Friends, Joy, Morningstar, Future and Bright Junior Secondary Secondary schools."","
"0","        names_numbers_schools == ""All the main Secondary Schools in Kalobeyei Settlement"" ~ "
"0","        ""Kalobeyei Settlement, Friends, Joy, Morningstar, Future and Bright Junior Secondary Secondary schools."", "
"0","        TRUE ~ names_numbers_schools)) %>% "
"0","    mutate("
"0","      number_schools = case_when("
"0","      activity == ""Provision of school meals to learners in the 8 primary schools and 7 pre-primary schools in Kalobeyei Settlement."" ~ 15,"
"0","      names_numbers_schools == ""22 refugee schools and 11 host community schools"" ~ 33,"
"0","      comments == ""37 schools supported with 115 handwashing kits"" ~ 37,"
"0","      str_detect(names_numbers_schools, ""\n"") ~ str_count(names_numbers_schools, ""\n"") + 1,"
"0","      str_detect(names_numbers_schools, ""\\,"") ~ str_count(names_numbers_schools, ""\\,|and|&"") + 1, "
"0","      str_detect(names_numbers_schools, ""and"") ~ str_count(names_numbers_schools, ""and"") + 1,"
"0","      str_detect(names_numbers_schools, ""\\;"") ~ str_count(names_numbers_schools, ""\\;"") + 1, "
"0","      !is.na(names_numbers_schools) ~ parse_number(names_numbers_schools), "
"0","      TRUE ~ NA_integer_), "
"0","      number_schools = ifelse(!is.na(names_numbers_schools) & is.na(number_schools), 1, number_schools)"
"0","      ) %>%"
"0","    replace_with_na(replace = list(names_numbers_schools = ""N/A"")) %>% "
"0","    # Standard_cleaning() goes here"
"0","    standard_cleaning() %>% "
"0","    filter(!is.na(month) & !is.na(lead_organisation) & !is.na(indicator)) %>% "
"0","    # Note the column here specifying the source, also with a filepath"
"0","    mutate(source = str_remove(source, "
"0","                             ""C:/Users/seanywng/Documents/R/eie_wg_5ws/data/5Ws_2023/"")) %>% "
"0","    filter(!is.na(indicator)) %>% "
"0","    mutate(implementing_partner = ifelse(is.na(implementing_partner), lead_organisation, implementing_partner))"
"0","    "
"0","  } "
"0",""
