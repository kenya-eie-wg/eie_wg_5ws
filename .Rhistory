sheet = "5W_Data_Entry",
skip = 2,
col_types = c(
"text", "text", "text", "text", "text", "text",
"text", "text", "text", "text", "text", "text",
"date", "date",
"text",
"numeric", "numeric", "numeric", "numeric",
"text", "numeric", "text"
)) %>%
setNames(names_5ws) %>%
mutate(source = file_list[i]) %>%
# Doing this here, but you can always move this to the end
# But this is the assumption that these lists are correct
mutate(
names_numbers_schools = case_when(
names_numbers_schools == "All the Juniour Secondary Schools (JSS) in Kalobeyei Settlement" ~
"Kalobeyei Settlement, Friends, Joy, Morningstar, Future and Bright Junior Secondary Secondary schools.",
names_numbers_schools == "All the main Secondary Schools in Kalobeyei Settlement" ~
"Kalobeyei Settlement, Friends, Joy, Morningstar, Future and Bright Junior Secondary Secondary schools.",
TRUE ~ names_numbers_schools)) %>%
mutate(
schools = case_when(
activity == "Provision of school meals to learners in the 8 primary schools and 7 pre-primary schools in Kalobeyei Settlement." ~ 15,
names_numbers_schools == "22 refugee schools and 11 host community schools" ~ 33,
comments == "37 schools supported with 115 handwashing kits" ~ 37,
str_detect(names_numbers_schools, "\n") ~ str_count(names_numbers_schools, "\n") + 1,
str_detect(names_numbers_schools, "\\,") ~ str_count(names_numbers_schools, "\\,|and|&") + 1,
str_detect(names_numbers_schools, "and") ~ str_count(names_numbers_schools, "and") + 1,
str_detect(names_numbers_schools, "\\;") ~ str_count(names_numbers_schools, "\\;") + 1,
!is.na(names_numbers_schools) ~ parse_number(names_numbers_schools),
TRUE ~ NA_integer_),
schools = ifelse(!is.na(names_numbers_schools) & is.na(schools), 1, schools)
) %>%
replace_with_na(replace = list(names_numbers_schools = "N/A")) %>%
filter(!is.na(month) & !is.na(lead_organisation) & !is.na(indicator)) %>%
mutate(county = recode(county,
"Tana_River" = "Tana River",
"Homa_Bay" = "Homa Bay",
"Home Bay" = "Homa Bay",
"West_Pokot" = "West Pokot",
"Taita_Taveta" = "Taita Taveta")) %>%
left_join(locations %>%
distinct(adm1_en, adm1_pcode),
by = c("county" = "adm1_en")) %>%
mutate(indicator = case_when(
str_detect(indicator, "in drought affected areas") ~ paste0("indicator 1 ", indicator),
str_detect(indicator, "feeding programmes") ~ paste0("indicator 2 ", indicator),
str_detect(indicator, "teaching materials") ~ paste0("indicator 3 ", indicator),
str_detect(indicator, "hygiene") ~ paste0("indicator 4 ", indicator),
str_detect(indicator, "educators trained on resilience") ~ paste0("indicator 5 ", indicator),
str_detect(indicator, "youth benefiting from resilience") ~ paste0("indicator 6 ", indicator),
TRUE ~ indicator
)) %>%
mutate(month = fct_relevel(month, c("January", "February", "March", "April",
"May", "June", "July", "August",
"September", "October", "November", "December"))) %>%
mutate_at(vars(implementing_partner, lead_organisation), ~ str_trim(str_squish(.))) %>%
mutate_at(vars(implementing_partner, lead_organisation), ~
case_when(
str_detect(., "AVSI") ~ "AVSI Foundation",
str_detect(., "Action for sustainable change|Action for Sustainable change") ~
"Action for Sustainable Change",
str_detect(., "FCA|FINN|Finn") ~ "Finn Church Aid",
str_detect(
., "LIFESKILL|Life skills|Lifeskills|LifeSkills|LISP|LISFESKILLS PROMOTERS|LIFESKIILS PROMOTERS") ~
"Lifeskills Promoters",
str_detect(., "ChildFund|Childfund") ~ "ChildFund Kenya",
. == "Missionary Sistrs of the catechism" ~ "Missionary Sisters of the Catechism",
str_detect(., "NRC|NORWEGIAN") ~ "Norwegian Refugee Council",
str_detect(., "SCI|Save the Children") ~ "Save the Children",
str_detect(., "World Vision|World vision|WVK BAMBA AP") ~ "World Vision Kenya",
str_detect(., "Nawiri Children Program") ~ "Nawiri Children Development Program",
str_detect(., "ERIKs development Partner") ~ "ERIKs Development Partner",
str_detect(., "Servants of the poor") ~ "Servants of the Poor",
str_detect(., "Evangelizing sisters of mary") ~ "Evangelizing Sisters of Mary",
str_detect(., "Voluntary Service Overseas|VSO") ~ "Voluntary Service Overseas",
str_detect(., "Homa Bay Counties") ~ "Homa Bay County",
str_detect(., "WERK") ~ "Women Educational Researchers of Kenya",
str_detect(., "Women Educational Researchers of Kenya,") ~ "Women Educational Researchers of Kenya",
str_detect(., "The Girl Child Network \\(GCN\\)") ~ "The Girl Child Network",
str_detect(., "FHK") ~ "Food for the Hungry",
str_detect(., "Futebol da Forcaa") ~ "Futebol da Forcaa",
. == "MOE" ~ "Ministry of Education",
. == "CDE Wajir" ~ "County Director of Education Wajir",
. == "CDE Mandera" ~ "County Director of Education Mandera",
. == "Girl Child Network" ~ "The Girl Child Network",
TRUE ~ .
))%>%
# Think about how you want to resolve the disaggregation issues
mutate(indicator = ifelse(
!is.na(boys) & str_detect(activity, "Training of children"),
"indicator 6 # of children and youth benefiting from resilience enhancing programmes (MHPSS, DRR & Life Skills, etc)", indicator)) %>%
mutate(indicator_short = case_when(
indicator == "indicator 1 # of children and youth accessing ECD spaces/schools in drought affected areas" ~
"1. Access ECD spaces/schools",
indicator == "indicator 2 # of schools/ECD spaces with feeding programmes" ~
"2. Feeding programmes",
# Not sure what's wrong with the text of this indicator
str_detect(indicator, "3") ~ "3. Teaching materials",
indicator == "indicator 4 # of schools with adequate quantites of safe water for drinking and personal hygiene" ~
"4. Safe water, personal hygiene",
indicator == "indicator 5 # of teachers / educators trained on resilience enhancing programmes (MHPSS, DRR & Life Skills, etc)" ~
"5. Educators resilience enhancing",
indicator == "indicator 6 # of children and youth benefiting from resilience enhancing programmes (MHPSS, DRR & Life Skills, etc)" ~
"6. Children resilience enhancing"
)) %>%
filter(!is.na(county) & total_reached > 0) %>%
mutate(sector_reached = ifelse(str_detect(indicator_short, "1|2|5|6"),
total_reached,
0)) %>%
mutate(source = str_remove(source,
"C:/Users/seanywng/Documents/R/eie_wg_5ws/data/5Ws_2023/")) %>%
filter(!is.na(indicator))
}
# Change the folder to the correct one
# The files will be read from here
file_list <- list.files(path = path_5ws,
recursive = TRUE,
pattern = "\\.xlsx$",
full.names = TRUE)
# Filtering out open? files? Not sure
file_list <- file_list[!str_detect(file_list, "\\~")]
# Ok, got the for loop to work
# Initialise empty data frame
eie <- data.frame()
# Loop
for (i in 1:length(file_list)) {
eie_i <- read_5ws(file_list[i])
eie <- rbind(eie, eie_i)
}
eie %>% count(lead_organisation, implementing_partner)
eie %>% filter(lead_organisation == "UNESCO")
read_5ws <- function(file) {
read_excel(file,
sheet = "5W_Data_Entry",
skip = 2,
col_types = c(
"text", "text", "text", "text", "text", "text",
"text", "text", "text", "text", "text", "text",
"date", "date",
"text",
"numeric", "numeric", "numeric", "numeric",
"text", "numeric", "text"
)) %>%
setNames(names_5ws) %>%
mutate(source = file_list[i]) %>%
# Doing this here, but you can always move this to the end
# But this is the assumption that these lists are correct
mutate(
names_numbers_schools = case_when(
names_numbers_schools == "All the Juniour Secondary Schools (JSS) in Kalobeyei Settlement" ~
"Kalobeyei Settlement, Friends, Joy, Morningstar, Future and Bright Junior Secondary Secondary schools.",
names_numbers_schools == "All the main Secondary Schools in Kalobeyei Settlement" ~
"Kalobeyei Settlement, Friends, Joy, Morningstar, Future and Bright Junior Secondary Secondary schools.",
TRUE ~ names_numbers_schools)) %>%
mutate(
schools = case_when(
activity == "Provision of school meals to learners in the 8 primary schools and 7 pre-primary schools in Kalobeyei Settlement." ~ 15,
names_numbers_schools == "22 refugee schools and 11 host community schools" ~ 33,
comments == "37 schools supported with 115 handwashing kits" ~ 37,
str_detect(names_numbers_schools, "\n") ~ str_count(names_numbers_schools, "\n") + 1,
str_detect(names_numbers_schools, "\\,") ~ str_count(names_numbers_schools, "\\,|and|&") + 1,
str_detect(names_numbers_schools, "and") ~ str_count(names_numbers_schools, "and") + 1,
str_detect(names_numbers_schools, "\\;") ~ str_count(names_numbers_schools, "\\;") + 1,
!is.na(names_numbers_schools) ~ parse_number(names_numbers_schools),
TRUE ~ NA_integer_),
schools = ifelse(!is.na(names_numbers_schools) & is.na(schools), 1, schools)
) %>%
replace_with_na(replace = list(names_numbers_schools = "N/A")) %>%
filter(!is.na(month) & !is.na(lead_organisation) & !is.na(indicator)) %>%
mutate(county = recode(county,
"Tana_River" = "Tana River",
"Homa_Bay" = "Homa Bay",
"Home Bay" = "Homa Bay",
"West_Pokot" = "West Pokot",
"Taita_Taveta" = "Taita Taveta")) %>%
left_join(locations %>%
distinct(adm1_en, adm1_pcode),
by = c("county" = "adm1_en")) %>%
mutate(indicator = case_when(
str_detect(indicator, "in drought affected areas") ~ paste0("indicator 1 ", indicator),
str_detect(indicator, "feeding programmes") ~ paste0("indicator 2 ", indicator),
str_detect(indicator, "teaching materials") ~ paste0("indicator 3 ", indicator),
str_detect(indicator, "hygiene") ~ paste0("indicator 4 ", indicator),
str_detect(indicator, "educators trained on resilience") ~ paste0("indicator 5 ", indicator),
str_detect(indicator, "youth benefiting from resilience") ~ paste0("indicator 6 ", indicator),
TRUE ~ indicator
)) %>%
mutate(month = fct_relevel(month, c("January", "February", "March", "April",
"May", "June", "July", "August",
"September", "October", "November", "December"))) %>%
mutate_at(vars(implementing_partner, lead_organisation), ~ str_trim(str_squish(.))) %>%
mutate_at(vars(implementing_partner, lead_organisation), ~
case_when(
str_detect(., "AVSI") ~ "AVSI Foundation",
str_detect(., "Action for sustainable change|Action for Sustainable change") ~
"Action for Sustainable Change",
str_detect(., "FCA|FINN|Finn") ~ "Finn Church Aid",
str_detect(
., "LIFESKILL|Life skills|Lifeskills|LifeSkills|LISP|LISFESKILLS PROMOTERS|LIFESKIILS PROMOTERS") ~
"Lifeskills Promoters",
str_detect(., "ChildFund|Childfund") ~ "ChildFund Kenya",
. == "Missionary Sistrs of the catechism" ~ "Missionary Sisters of the Catechism",
str_detect(., "NRC|NORWEGIAN") ~ "Norwegian Refugee Council",
str_detect(., "SCI|Save the Children") ~ "Save the Children",
str_detect(., "World Vision|World vision|WVK BAMBA AP") ~ "World Vision Kenya",
str_detect(., "Nawiri Children Program") ~ "Nawiri Children Development Program",
str_detect(., "ERIKs development Partner") ~ "ERIKs Development Partner",
str_detect(., "Servants of the poor") ~ "Servants of the Poor",
str_detect(., "Evangelizing sisters of mary") ~ "Evangelizing Sisters of Mary",
str_detect(., "Voluntary Service Overseas|VSO") ~ "Voluntary Service Overseas",
str_detect(., "Homa Bay Counties") ~ "Homa Bay County",
str_detect(., "WERK") ~ "Women Educational Researchers of Kenya",
str_detect(., "Women Educational Researchers of Kenya,") ~ "Women Educational Researchers of Kenya",
str_detect(., "The Girl Child Network \\(GCN\\)") ~ "The Girl Child Network",
str_detect(., "FHK") ~ "Food for the Hungry",
str_detect(., "Futebol da Forcaa") ~ "Futebol da Forcaa",
. == "MOE" ~ "Ministry of Education",
. == "CDE Wajir" ~ "County Director of Education Wajir",
. == "CDE Mandera" ~ "County Director of Education Mandera",
. == "Girl Child Network" ~ "The Girl Child Network",
TRUE ~ .
))%>%
# Think about how you want to resolve the disaggregation issues
mutate(indicator = ifelse(
!is.na(boys) & str_detect(activity, "Training of children"),
"indicator 6 # of children and youth benefiting from resilience enhancing programmes (MHPSS, DRR & Life Skills, etc)", indicator)) %>%
mutate(indicator_short = case_when(
indicator == "indicator 1 # of children and youth accessing ECD spaces/schools in drought affected areas" ~
"1. Access ECD spaces/schools",
indicator == "indicator 2 # of schools/ECD spaces with feeding programmes" ~
"2. Feeding programmes",
# Not sure what's wrong with the text of this indicator
str_detect(indicator, "3") ~ "3. Teaching materials",
indicator == "indicator 4 # of schools with adequate quantites of safe water for drinking and personal hygiene" ~
"4. Safe water, personal hygiene",
indicator == "indicator 5 # of teachers / educators trained on resilience enhancing programmes (MHPSS, DRR & Life Skills, etc)" ~
"5. Educators resilience enhancing",
indicator == "indicator 6 # of children and youth benefiting from resilience enhancing programmes (MHPSS, DRR & Life Skills, etc)" ~
"6. Children resilience enhancing"
)) %>%
filter(!is.na(county) & total_reached > 0) %>%
mutate(sector_reached = ifelse(str_detect(indicator_short, "1|2|5|6"),
total_reached,
0)) %>%
mutate(source = str_remove(source,
"C:/Users/seanywng/Documents/R/eie_wg_5ws/data/5Ws_2023/")) %>%
filter(!is.na(indicator))
}
# Change the folder to the correct one
# The files will be read from here
file_list <- list.files(path = path_5ws,
recursive = TRUE,
pattern = "\\.xlsx$",
full.names = TRUE)
# Filtering out open? files? Not sure
file_list <- file_list[!str_detect(file_list, "\\~")]
# Ok, got the for loop to work
# Initialise empty data frame
eie <- data.frame()
# Loop
for (i in 1:length(file_list)) {
eie_i <- read_5ws(file_list[i])
eie <- rbind(eie, eie_i)
}
eie %>%
mutate(total_reached_check = rowSums(.[16:19], na.rm = TRUE)) %>%
filter(total_reached_check != total_reached)
eie %>%
filter(is.na(adm1_pcode)) %>%
distinct(county)
eie %>% count(lead_organisation, implementing_partner)
# Write
eie %>%
write_csv("./data/eie_5ws.csv")
partners_raw
eie %>% count(implementing_partner)
read_5ws <- function(file) {
read_excel(file,
sheet = "5W_Data_Entry",
skip = 2,
col_types = c(
"text", "text", "text", "text", "text", "text",
"text", "text", "text", "text", "text", "text",
"date", "date",
"text",
"numeric", "numeric", "numeric", "numeric",
"text", "numeric", "text"
)) %>%
setNames(names_5ws) %>%
mutate(source = file_list[i]) %>%
# Doing this here, but you can always move this to the end
# But this is the assumption that these lists are correct
mutate(
names_numbers_schools = case_when(
names_numbers_schools == "All the Juniour Secondary Schools (JSS) in Kalobeyei Settlement" ~
"Kalobeyei Settlement, Friends, Joy, Morningstar, Future and Bright Junior Secondary Secondary schools.",
names_numbers_schools == "All the main Secondary Schools in Kalobeyei Settlement" ~
"Kalobeyei Settlement, Friends, Joy, Morningstar, Future and Bright Junior Secondary Secondary schools.",
TRUE ~ names_numbers_schools)) %>%
mutate(
schools = case_when(
activity == "Provision of school meals to learners in the 8 primary schools and 7 pre-primary schools in Kalobeyei Settlement." ~ 15,
names_numbers_schools == "22 refugee schools and 11 host community schools" ~ 33,
comments == "37 schools supported with 115 handwashing kits" ~ 37,
str_detect(names_numbers_schools, "\n") ~ str_count(names_numbers_schools, "\n") + 1,
str_detect(names_numbers_schools, "\\,") ~ str_count(names_numbers_schools, "\\,|and|&") + 1,
str_detect(names_numbers_schools, "and") ~ str_count(names_numbers_schools, "and") + 1,
str_detect(names_numbers_schools, "\\;") ~ str_count(names_numbers_schools, "\\;") + 1,
!is.na(names_numbers_schools) ~ parse_number(names_numbers_schools),
TRUE ~ NA_integer_),
schools = ifelse(!is.na(names_numbers_schools) & is.na(schools), 1, schools)
) %>%
replace_with_na(replace = list(names_numbers_schools = "N/A")) %>%
filter(!is.na(month) & !is.na(lead_organisation) & !is.na(indicator)) %>%
mutate(county = recode(county,
"Tana_River" = "Tana River",
"Homa_Bay" = "Homa Bay",
"Home Bay" = "Homa Bay",
"West_Pokot" = "West Pokot",
"Taita_Taveta" = "Taita Taveta")) %>%
left_join(locations %>%
distinct(adm1_en, adm1_pcode),
by = c("county" = "adm1_en")) %>%
mutate(indicator = case_when(
str_detect(indicator, "in drought affected areas") ~ paste0("indicator 1 ", indicator),
str_detect(indicator, "feeding programmes") ~ paste0("indicator 2 ", indicator),
str_detect(indicator, "teaching materials") ~ paste0("indicator 3 ", indicator),
str_detect(indicator, "hygiene") ~ paste0("indicator 4 ", indicator),
str_detect(indicator, "educators trained on resilience") ~ paste0("indicator 5 ", indicator),
str_detect(indicator, "youth benefiting from resilience") ~ paste0("indicator 6 ", indicator),
TRUE ~ indicator
)) %>%
mutate(month = fct_relevel(month, c("January", "February", "March", "April",
"May", "June", "July", "August",
"September", "October", "November", "December"))) %>%
mutate_at(vars(implementing_partner, lead_organisation), ~ str_trim(str_squish(.))) %>%
mutate_at(vars(implementing_partner, lead_organisation), ~
case_when(
str_detect(., "AVSI") ~ "AVSI Foundation",
str_detect(., "Action for sustainable change|Action for Sustainable change") ~
"Action for Sustainable Change",
str_detect(., "FCA|FINN|Finn") ~ "Finn Church Aid",
str_detect(
., "LIFESKILL|Life skills|Lifeskills|LifeSkills|LISP|LISFESKILLS PROMOTERS|LIFESKIILS PROMOTERS") ~
"Lifeskills Promoters",
str_detect(., "ChildFund|Childfund") ~ "ChildFund Kenya",
. == "Missionary Sistrs of the catechism" ~ "Missionary Sisters of the Catechism",
str_detect(., "NRC|NORWEGIAN") ~ "Norwegian Refugee Council",
str_detect(., "SCI|Save the Children") ~ "Save the Children",
str_detect(., "World Vision|World vision|WVK BAMBA AP") ~ "World Vision Kenya",
str_detect(., "Nawiri Children Program") ~ "Nawiri Children Development Program",
str_detect(., "ERIKs development Partner") ~ "ERIKs Development Partner",
str_detect(., "Servants of the poor") ~ "Servants of the Poor",
str_detect(., "Evangelizing sisters of mary") ~ "Evangelizing Sisters of Mary",
str_detect(., "Voluntary Service Overseas|VSO") ~ "Voluntary Service Overseas",
str_detect(., "Homa Bay Counties") ~ "Homa Bay County",
str_detect(., "WERK") ~ "Women Educational Researchers of Kenya",
str_detect(., "Women Educational Researchers of Kenya,") ~ "Women Educational Researchers of Kenya",
str_detect(., "The Girl Child Network \\(GCN\\)") ~ "The Girl Child Network",
str_detect(., "FHK") ~ "Food for the Hungry",
str_detect(., "Futebol da Forcaa") ~ "Futebol da Forcaa",
. == "MOE" ~ "Ministry of Education",
. == "CDE Wajir" ~ "County Director of Education Wajir",
. == "CDE Mandera" ~ "County Director of Education Mandera",
. == "Girl Child Network" ~ "The Girl Child Network",
. == "SC" ~ "Save the Children"
TRUE ~ .
read_5ws <- function(file) {
read_excel(file,
sheet = "5W_Data_Entry",
skip = 2,
col_types = c(
"text", "text", "text", "text", "text", "text",
"text", "text", "text", "text", "text", "text",
"date", "date",
"text",
"numeric", "numeric", "numeric", "numeric",
"text", "numeric", "text"
)) %>%
setNames(names_5ws) %>%
mutate(source = file_list[i]) %>%
# Doing this here, but you can always move this to the end
# But this is the assumption that these lists are correct
mutate(
names_numbers_schools = case_when(
names_numbers_schools == "All the Juniour Secondary Schools (JSS) in Kalobeyei Settlement" ~
"Kalobeyei Settlement, Friends, Joy, Morningstar, Future and Bright Junior Secondary Secondary schools.",
names_numbers_schools == "All the main Secondary Schools in Kalobeyei Settlement" ~
"Kalobeyei Settlement, Friends, Joy, Morningstar, Future and Bright Junior Secondary Secondary schools.",
TRUE ~ names_numbers_schools)) %>%
mutate(
schools = case_when(
activity == "Provision of school meals to learners in the 8 primary schools and 7 pre-primary schools in Kalobeyei Settlement." ~ 15,
names_numbers_schools == "22 refugee schools and 11 host community schools" ~ 33,
comments == "37 schools supported with 115 handwashing kits" ~ 37,
str_detect(names_numbers_schools, "\n") ~ str_count(names_numbers_schools, "\n") + 1,
str_detect(names_numbers_schools, "\\,") ~ str_count(names_numbers_schools, "\\,|and|&") + 1,
str_detect(names_numbers_schools, "and") ~ str_count(names_numbers_schools, "and") + 1,
str_detect(names_numbers_schools, "\\;") ~ str_count(names_numbers_schools, "\\;") + 1,
!is.na(names_numbers_schools) ~ parse_number(names_numbers_schools),
TRUE ~ NA_integer_),
schools = ifelse(!is.na(names_numbers_schools) & is.na(schools), 1, schools)
) %>%
replace_with_na(replace = list(names_numbers_schools = "N/A")) %>%
filter(!is.na(month) & !is.na(lead_organisation) & !is.na(indicator)) %>%
mutate(county = recode(county,
"Tana_River" = "Tana River",
"Homa_Bay" = "Homa Bay",
"Home Bay" = "Homa Bay",
"West_Pokot" = "West Pokot",
"Taita_Taveta" = "Taita Taveta")) %>%
left_join(locations %>%
distinct(adm1_en, adm1_pcode),
by = c("county" = "adm1_en")) %>%
mutate(indicator = case_when(
str_detect(indicator, "in drought affected areas") ~ paste0("indicator 1 ", indicator),
str_detect(indicator, "feeding programmes") ~ paste0("indicator 2 ", indicator),
str_detect(indicator, "teaching materials") ~ paste0("indicator 3 ", indicator),
str_detect(indicator, "hygiene") ~ paste0("indicator 4 ", indicator),
str_detect(indicator, "educators trained on resilience") ~ paste0("indicator 5 ", indicator),
str_detect(indicator, "youth benefiting from resilience") ~ paste0("indicator 6 ", indicator),
TRUE ~ indicator
)) %>%
mutate(month = fct_relevel(month, c("January", "February", "March", "April",
"May", "June", "July", "August",
"September", "October", "November", "December"))) %>%
mutate_at(vars(implementing_partner, lead_organisation), ~ str_trim(str_squish(.))) %>%
mutate_at(vars(implementing_partner, lead_organisation), ~
case_when(
str_detect(., "AVSI") ~ "AVSI Foundation",
str_detect(., "Action for sustainable change|Action for Sustainable change") ~
"Action for Sustainable Change",
str_detect(., "FCA|FINN|Finn") ~ "Finn Church Aid",
str_detect(
., "LIFESKILL|Life skills|Lifeskills|LifeSkills|LISP|LISFESKILLS PROMOTERS|LIFESKIILS PROMOTERS") ~
"Lifeskills Promoters",
str_detect(., "ChildFund|Childfund") ~ "ChildFund Kenya",
. == "Missionary Sistrs of the catechism" ~ "Missionary Sisters of the Catechism",
str_detect(., "NRC|NORWEGIAN") ~ "Norwegian Refugee Council",
str_detect(., "SCI|Save the Children") ~ "Save the Children",
str_detect(., "World Vision|World vision|WVK BAMBA AP") ~ "World Vision Kenya",
str_detect(., "Nawiri Children Program") ~ "Nawiri Children Development Program",
str_detect(., "ERIKs development Partner") ~ "ERIKs Development Partner",
str_detect(., "Servants of the poor") ~ "Servants of the Poor",
str_detect(., "Evangelizing sisters of mary") ~ "Evangelizing Sisters of Mary",
str_detect(., "Voluntary Service Overseas|VSO") ~ "Voluntary Service Overseas",
str_detect(., "Homa Bay Counties") ~ "Homa Bay County",
str_detect(., "WERK") ~ "Women Educational Researchers of Kenya",
str_detect(., "Women Educational Researchers of Kenya,") ~ "Women Educational Researchers of Kenya",
str_detect(., "The Girl Child Network \\(GCN\\)") ~ "The Girl Child Network",
str_detect(., "FHK") ~ "Food for the Hungry",
str_detect(., "Futebol da Forcaa") ~ "Futebol da Forcaa",
. == "MOE" ~ "Ministry of Education",
. == "CDE Wajir" ~ "County Director of Education Wajir",
. == "CDE Mandera" ~ "County Director of Education Mandera",
. == "Girl Child Network" ~ "The Girl Child Network",
. == "SC" ~ "Save the Children",
TRUE ~ .
))%>%
# Think about how you want to resolve the disaggregation issues
mutate(indicator = ifelse(
!is.na(boys) & str_detect(activity, "Training of children"),
"indicator 6 # of children and youth benefiting from resilience enhancing programmes (MHPSS, DRR & Life Skills, etc)", indicator)) %>%
mutate(indicator_short = case_when(
indicator == "indicator 1 # of children and youth accessing ECD spaces/schools in drought affected areas" ~
"1. Access ECD spaces/schools",
indicator == "indicator 2 # of schools/ECD spaces with feeding programmes" ~
"2. Feeding programmes",
# Not sure what's wrong with the text of this indicator
str_detect(indicator, "3") ~ "3. Teaching materials",
indicator == "indicator 4 # of schools with adequate quantites of safe water for drinking and personal hygiene" ~
"4. Safe water, personal hygiene",
indicator == "indicator 5 # of teachers / educators trained on resilience enhancing programmes (MHPSS, DRR & Life Skills, etc)" ~
"5. Educators resilience enhancing",
indicator == "indicator 6 # of children and youth benefiting from resilience enhancing programmes (MHPSS, DRR & Life Skills, etc)" ~
"6. Children resilience enhancing"
)) %>%
filter(!is.na(county) & total_reached > 0) %>%
mutate(sector_reached = ifelse(str_detect(indicator_short, "1|2|5|6"),
total_reached,
0)) %>%
mutate(source = str_remove(source,
"C:/Users/seanywng/Documents/R/eie_wg_5ws/data/5Ws_2023/")) %>%
filter(!is.na(indicator))
}
# Change the folder to the correct one
# The files will be read from here
file_list <- list.files(path = path_5ws,
recursive = TRUE,
pattern = "\\.xlsx$",
full.names = TRUE)
# Filtering out open? files? Not sure
file_list <- file_list[!str_detect(file_list, "\\~")]
# Ok, got the for loop to work
# Initialise empty data frame
eie <- data.frame()
# Loop
for (i in 1:length(file_list)) {
eie_i <- read_5ws(file_list[i])
eie <- rbind(eie, eie_i)
}
eie %>%
mutate(total_reached_check = rowSums(.[16:19], na.rm = TRUE)) %>%
filter(total_reached_check != total_reached)
eie %>%
filter(is.na(adm1_pcode)) %>%
distinct(county)
# Write
eie %>%
write_csv("./data/eie_5ws.csv")
