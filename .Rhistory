scale_fill_manual(values = c("#443983", "#35b779")) +
geom_text(aes(x = value,
y = county,
label = comma(value)),
position = position_dodge(width = .9),
hjust = .5) +
labs(x = "Number of children",
y = "",
title = "OOSC accessing formal/informal education") +
scale_x_continuous(labels = comma)
combined %>%
filter(str_detect(unicef_indicator, "1") &
beneficiary_group == "all" &
age_modifier == "children") %>%
group_by(county, sex_modifier) %>%
summarise(value = sum(value, na.rm = TRUE)) %>%
group_by(county) %>%
mutate(county_total = sum(value)) %>%
ungroup() %>%
mutate(county = fct_reorder(county, county_total)) %>%
arrange(county) %>%
ggplot(aes(x = value, y = county, fill = sex_modifier)) +
geom_col(position = position_dodge(width = .9)) +
scale_fill_manual(values = c("#443983", "#35b779")) +
geom_text(aes(x = value,
y = county,
label = comma(value)),
position = "inward") +
labs(x = "Number of children",
y = "",
title = "OOSC accessing formal/informal education") +
scale_x_continuous(labels = comma)
combined %>%
filter(str_detect(unicef_indicator, "1") &
beneficiary_group == "all" &
age_modifier == "children") %>%
group_by(county, sex_modifier) %>%
summarise(value = sum(value, na.rm = TRUE)) %>%
group_by(county) %>%
mutate(county_total = sum(value)) %>%
ungroup() %>%
mutate(county = fct_reorder(county, county_total)) %>%
arrange(county) %>%
ggplot(aes(x = value, y = county, fill = sex_modifier)) +
geom_col(position = position_dodge(width = .9)) +
scale_fill_manual(values = c("#443983", "#35b779")) +
geom_text(aes(x = value,
y = county,
label = comma(value)),
position = position_dodge(width = .9),
hjust = "inward") +
labs(x = "Number of children",
y = "",
title = "OOSC accessing formal/informal education") +
scale_x_continuous(labels = comma)
combined %>%
filter(str_detect(unicef_indicator, "1") &
beneficiary_group == "all" &
age_modifier == "children") %>%
group_by(county, sex_modifier) %>%
summarise(value = sum(value, na.rm = TRUE)) %>%
group_by(county) %>%
mutate(county_total = sum(value)) %>%
ungroup() %>%
mutate(county = fct_reorder(county, county_total)) %>%
arrange(county) %>%
ggplot(aes(x = value, y = county, fill = sex_modifier)) +
geom_col(position = position_dodge(width = .9)) +
scale_fill_manual(values = c("#443983", "#35b779")) +
geom_text(aes(x = value,
y = county,
label = comma(value)),
position = position_dodge(width = .8),
hjust = "inward") +
labs(x = "Number of children",
y = "",
title = "OOSC accessing formal/informal education") +
scale_x_continuous(labels = comma)
combined %>%
filter(str_detect(unicef_indicator, "1") &
beneficiary_group == "all" &
age_modifier == "children") %>%
group_by(county, sex_modifier) %>%
summarise(value = sum(value, na.rm = TRUE)) %>%
group_by(county) %>%
mutate(county_total = sum(value),
pc = value / county_total) %>%
ungroup() %>%
mutate(county = fct_reorder(county, county_total)) %>%
arrange(county) %>%
ggplot(aes(x = value, y = county, fill = sex_modifier)) +
geom_col(position = position_dodge(width = .9)) +
scale_fill_manual(values = c("#443983", "#35b779")) +
geom_text(aes(x = value,
y = county,
label = percent(pc)),
position = position_dodge(width = .8),
hjust = "inward") +
labs(x = "Number of children",
y = "",
title = "OOSC accessing formal/informal education") +
scale_x_continuous(labels = comma)
combined %>%
filter(str_detect(unicef_indicator, "1") &
beneficiary_group == "all" &
age_modifier == "children") %>%
group_by(county, sex_modifier) %>%
summarise(value = sum(value, na.rm = TRUE)) %>%
group_by(county) %>%
mutate(county_total = sum(value),
pc = value / county_total) %>%
ungroup() %>%
mutate(county = fct_reorder(county, county_total)) %>%
arrange(county) %>%
ggplot(aes(x = value, y = county, fill = sex_modifier)) +
geom_col(position = position_dodge(width = .9)) +
scale_fill_manual(values = c("#443983", "#35b779")) +
geom_text(aes(x = value,
y = county,
label = percent(pc, accuracy = 1)),
position = position_dodge(width = .8),
hjust = "inward") +
labs(x = "Number of children",
y = "",
title = "OOSC accessing formal/informal education") +
scale_x_continuous(labels = comma)
combined %>%
filter(str_detect(unicef_indicator, "1") &
beneficiary_group == "all" &
age_modifier == "children") %>%
group_by(county, sex_modifier) %>%
summarise(value = sum(value, na.rm = TRUE)) %>%
group_by(county) %>%
mutate(county_total = sum(value),
pc = value / county_total) %>%
ungroup() %>%
mutate(county = fct_reorder(county, county_total)) %>%
arrange(county) %>%
ggplot(aes(x = value, y = county, fill = sex_modifier)) +
geom_col(position = position_dodge(width = .9)) +
scale_fill_manual(values = c("#443983", "#35b779")) +
geom_text(aes(x = value,
y = county,
label = percent(pc, accuracy = 1)),
position = position_dodge(width = .8),
hjust = "inward") +
labs(x = "Number of children",
y = "",
title = "Sex ratio of OOSC accessing formal/informal education") +
scale_x_continuous(labels = comma)
ggsave("./img/oosc_example_plot.png",
height = 8, width = 11, units = "in")
combined
combined %>%
filter(!str_detect(sub_indicator, "total|all")) %>%
group_by(sub_indicator) %>%
summarise(value = sum(value, na.rm = TRUE))
combined %>%
filter(!str_detect(unicef_indicator, sub_indicator, "total|all")) %>%
group_by(sub_indicator) %>%
summarise(value = sum(value, na.rm = TRUE))
combined %>%
filter(!str_detect(sub_indicator, "total|all")) %>%
group_by(unicef_indicator, sub_indicator) %>%
summarise(value = sum(value, na.rm = TRUE))
combined %>%
filter(!str_detect(sub_indicator, "total|all")) %>%
group_by(unicef_indicator, sub_indicator) %>%
summarise(value = sum(value, na.rm = TRUE)) %>%
write_csv("./data/summary_by_indicator.csv")
combined %>%
filter(str_detect(sub_indicator, "total|all")) %>%
group_by(unicef_indicator, sub_indicator)
combined %>%
group_by(unicef_indicator, sub_indicator) %>%
summarise(value = sum(value, na.rm = TRUE))
combined %>%
filter(beneficiary_group == "all",
sex_modifier == "total",
age_modifier == "total")
combined %>% count(age_modifier)
combined <- read_excel("./data/unicef_internal/Monthly Education SitRep_Jun23_mohamed.xlsx") %>%
clean_messy_table() %>%
rename(mohamed_value = value) %>%
left_join(read_excel("./data/unicef_internal/June  Monthly Education SitRep_Jun23 Kwale Kilifi Kajiado and Narok.xlsx") %>%
clean_messy_table() %>%
rename(beth_value = value),
by = c("month", "county", "indicator")) %>%
left_join(read_excel("./data/unicef_internal/Monthly Education SitRep_Jun2326062023_osman.xlsx") %>%
clean_messy_table() %>%
rename(osman_value = value),
by = c("month", "county", "indicator")) %>%
mutate(value = case_when(!is.na(mohamed_value) & !is.na(beth_value) & !is.na(osman_value) ~
pmax(mohamed_value, beth_value, osman_value),
!is.na(mohamed_value) & !is.na(beth_value) ~
pmax(mohamed_value, beth_value),
!is.na(mohamed_value) & !is.na(osman_value) ~
pmax(mohamed_value, osman_value),
!is.na(beth_value) & !is.na(osman_value) ~
pmax(beth_value, osman_value),
is.na(mohamed_value) & is.na(beth_value) ~ osman_value,
is.na(osman_value) & is.na(beth_value) ~ mohamed_value,
is.na(osman_value) & is.na(mohamed_value) ~ beth_value,
TRUE ~ NA_integer_)) %>%
mutate(sex_modifier = case_when(str_detect(indicator, "girls|women|Women|Girls|Female|female") ~ "female",
str_detect(indicator, "boys|Boys|men|Men|Male|male") ~ "male",
str_detect(indicator, "total") ~ "total"),
beneficiary_group = case_when(str_detect(indicator, "host_community") ~ "host_community",
str_detect(indicator, "idps") ~ "idps",
str_detect(indicator, "refugees") ~ "refugees",
str_detect(indicator, "all") ~ "all"),
age_modifier = case_when(str_detect(indicator, "boys|girls") ~ "children",
str_detect(indicator, "Male|male|Female|female") ~ "adults",
str_detect(indicator, "all") ~ "total")) %>%
mutate(unicef_indicator_number = as.factor(parse_number(indicator)),
unicef_indicator = case_when(str_detect(indicator, "1") ~
"1. OOSC accessing formal education",
str_detect(indicator, "2") ~
"2. Children benefiting from child-friendly environment",
str_detect(indicator, "3") ~
"3. Children who receive assistance to continue learning",
str_detect(indicator, "4") ~
"4. Teachers trained resilience programmes",
str_detect(indicator, "5") ~
"5. BoM trained resilience programmes",
str_detect(indicator, "6") ~
"6. Govt. officials trained",
str_detect(indicator, "7") ~
"7. Children life skills mentorship")) %>%
rename(sub_indicator = indicator) %>%
select(-mohamed_value, -beth_value, -osman_value)
combined %>% write_csv("./data/combined.csv")
combined %>%
select(month, county, sub_indicator, value) %>%
pivot_wider(names_from = sub_indicator,
values_from = value) %>%
write_csv("flat_table.csv")
combined %>%
group_by(unicef_indicator, sub_indicator) %>%
summarise(value = sum(value, na.rm = TRUE)) %>%
write_csv("./data/summary_by_sub_indicator.csv")
combined %>%
group_by(unicef_indicator, sub_indicator) %>%
summarise(value = sum(value, na.rm = TRUE))
combined %>%
filter(beneficiary_group == "all",
sex_modifier == "total",
age_modifier == "total")
combined %>%
filter(beneficiary_group == "all",
sex_modifier == "total",
age_modifier == "total") %>%
group_by(county) %>%
summarise(value = sum(value, na.rm = TRUE))
combined %>%
filter(beneficiary_group == "all",
sex_modifier == "total",
age_modifier == "total") %>%
group_by(county, month) %>%
summarise(value = sum(value, na.rm = TRUE))
combined %>%
filter(beneficiary_group == "all",
sex_modifier == "total",
age_modifier == "total") %>%
group_by(county) %>%
summarise(value = sum(value, na.rm = TRUE)) %>%
write_csv("./data/summary_by_county.csv")
combined %>%
select(month, county, sub_indicator, value) %>%
pivot_wider(names_from = sub_indicator,
values_from = value) %>%
write_csv("flat_table.csv")
combined %>%
select(month, county, sub_indicator, value) %>%
pivot_wider(names_from = sub_indicator,
values_from = value) %>%
write_csv("./data/flat_table.csv")
targets <- read_excel(file_list[3],
sheet = "Reach by Indicator",
skip = 1) %>%
clean_names() %>%
select(x1, x2,
contains("target")) %>%
setNames(c("county",
"county_overall_target",
"indicator1_target_children",
"indicator2_target",
"indicator3_target_people",
"indicator4_target",
"indicator5_target_educators",
"indicator6_target_children")) %>%
slice(0:23) %>%
separate(indicator2_target, into = c("indicator2_target_schools", "indicator2_target_children"), sep = "\\(") %>%
separate(indicator4_target, into = c("indicator4_target_schools", "indicator4_target_children"), sep = "\\(") %>%
mutate_at(vars(indicator2_target_schools,
indicator2_target_children,
indicator4_target_schools,
indicator4_target_children),
~ parse_number(.)) %>%
pivot_longer(cols = indicator1_target_children:indicator6_target_children,
names_to = "type",
values_to = "county_target") %>%
mutate(number = parse_number(type),
indicator = case_when(
str_detect(type, "1") ~ "number of children and youth accessing ECD spaces/schools in drought-affected areas",
str_detect(type, "2") ~ "number of schools/ECD spaces with feeding programmes",
str_detect(type, "3") ~ "number of learners and teachers with learning and teaching materials",
str_detect(type, "4") ~ "number of schools with adequate quantities of safe water for drinking and personal hygiene",
str_detect(type, "5") ~ "number of teachers/educaotrs trained on resilience-enhancing programmes",
str_detect(type, "6") ~ "number of children and youth benefiting from resiliece-enhancing programmes")) %>%
mutate(target_unit = str_sub(type, start = 19L)) %>%
select(county, number, indicator, county_target, target_unit, county_overall_target) %>%
mutate(indicator_short = case_when(
indicator == "indicator 1 # of children and youth accessing ECD spaces/schools in drought affected areas" ~
"1. Access ECD spaces/schools",
indicator == "indicator 2 # of schools/ECD spaces with feeding programmes" ~
"2. Feeding programmes",
# Not sure what's wrong with the text of this indicator
str_detect(indicator, "3") ~ "3. Teaching materials",
indicator == "indicator 4 # of schools with adequate quantites of safe water for drinking and personal hygiene" ~
"4. Safe water, personal hygiene",
indicator == "indicator 5 # of teachers / educators trained on resilience enhancing programmes (MHPSS, DRR & Life Skills, etc)" ~
"5. Educators resilience enhancing",
indicator == "indicator 6 # of children and youth benefiting from resilience enhancing programmes (MHPSS, DRR & Life Skills, etc)" ~
"6. Children resilience enhancing"
))
targets <- read_excel("./data/5Ws_2023/Consolidated 5W_ Education_Mar 2023 Report.xlsx",
sheet = "Reach by Indicator",
skip = 1) %>%
clean_names() %>%
select(x1, x2,
contains("target")) %>%
setNames(c("county",
"county_overall_target",
"indicator1_target_children",
"indicator2_target",
"indicator3_target_people",
"indicator4_target",
"indicator5_target_educators",
"indicator6_target_children")) %>%
slice(0:23) %>%
separate(indicator2_target, into = c("indicator2_target_schools", "indicator2_target_children"), sep = "\\(") %>%
separate(indicator4_target, into = c("indicator4_target_schools", "indicator4_target_children"), sep = "\\(") %>%
mutate_at(vars(indicator2_target_schools,
indicator2_target_children,
indicator4_target_schools,
indicator4_target_children),
~ parse_number(.)) %>%
pivot_longer(cols = indicator1_target_children:indicator6_target_children,
names_to = "type",
values_to = "county_target") %>%
mutate(number = parse_number(type),
indicator = case_when(
str_detect(type, "1") ~ "number of children and youth accessing ECD spaces/schools in drought-affected areas",
str_detect(type, "2") ~ "number of schools/ECD spaces with feeding programmes",
str_detect(type, "3") ~ "number of learners and teachers with learning and teaching materials",
str_detect(type, "4") ~ "number of schools with adequate quantities of safe water for drinking and personal hygiene",
str_detect(type, "5") ~ "number of teachers/educaotrs trained on resilience-enhancing programmes",
str_detect(type, "6") ~ "number of children and youth benefiting from resiliece-enhancing programmes")) %>%
mutate(target_unit = str_sub(type, start = 19L)) %>%
select(county, number, indicator, county_target, target_unit, county_overall_target) %>%
mutate(indicator_short = case_when(
indicator == "indicator 1 # of children and youth accessing ECD spaces/schools in drought affected areas" ~
"1. Access ECD spaces/schools",
indicator == "indicator 2 # of schools/ECD spaces with feeding programmes" ~
"2. Feeding programmes",
# Not sure what's wrong with the text of this indicator
str_detect(indicator, "3") ~ "3. Teaching materials",
indicator == "indicator 4 # of schools with adequate quantites of safe water for drinking and personal hygiene" ~
"4. Safe water, personal hygiene",
indicator == "indicator 5 # of teachers / educators trained on resilience enhancing programmes (MHPSS, DRR & Life Skills, etc)" ~
"5. Educators resilience enhancing",
indicator == "indicator 6 # of children and youth benefiting from resilience enhancing programmes (MHPSS, DRR & Life Skills, etc)" ~
"6. Children resilience enhancing"
))
targets %>%
write_csv("./data/eie_targets.csv")
targets
targets <- read_excel("./data/5Ws_2023/Consolidated 5W_ Education_Mar 2023 Report.xlsx",
sheet = "Reach by Indicator",
skip = 1) %>%
clean_names() %>%
select(x1, x2,
contains("target")) %>%
setNames(c("county",
"county_overall_target",
"indicator1_target_children",
"indicator2_target",
"indicator3_target_people",
"indicator4_target",
"indicator5_target_educators",
"indicator6_target_children")) %>%
slice(0:23) %>%
separate(indicator2_target, into = c("indicator2_target_schools", "indicator2_target_children"), sep = "\\(") %>%
separate(indicator4_target, into = c("indicator4_target_schools", "indicator4_target_children"), sep = "\\(") %>%
mutate_at(vars(indicator2_target_schools,
indicator2_target_children,
indicator4_target_schools,
indicator4_target_children),
~ parse_number(.)) %>%
pivot_longer(cols = indicator1_target_children:indicator6_target_children,
names_to = "type",
values_to = "county_target") %>%
mutate(indicator_number = parse_number(type),
indicator = case_when(
str_detect(type, "1") ~ "number of children and youth accessing ECD spaces/schools in drought-affected areas",
str_detect(type, "2") ~ "number of schools/ECD spaces with feeding programmes",
str_detect(type, "3") ~ "number of learners and teachers with learning and teaching materials",
str_detect(type, "4") ~ "number of schools with adequate quantities of safe water for drinking and personal hygiene",
str_detect(type, "5") ~ "number of teachers/educaotrs trained on resilience-enhancing programmes",
str_detect(type, "6") ~ "number of children and youth benefiting from resiliece-enhancing programmes")) %>%
mutate(target_unit = str_sub(type, start = 19L)) %>%
select(county, indicator_number, indicator, county_target, target_unit, county_overall_target) %>%
mutate(indicator_short = case_when(
indicator == "indicator 1 # of children and youth accessing ECD spaces/schools in drought affected areas" ~
"1. Access ECD spaces/schools",
indicator == "indicator 2 # of schools/ECD spaces with feeding programmes" ~
"2. Feeding programmes",
# Not sure what's wrong with the text of this indicator
str_detect(indicator, "3") ~ "3. Teaching materials",
indicator == "indicator 4 # of schools with adequate quantites of safe water for drinking and personal hygiene" ~
"4. Safe water, personal hygiene",
indicator == "indicator 5 # of teachers / educators trained on resilience enhancing programmes (MHPSS, DRR & Life Skills, etc)" ~
"5. Educators resilience enhancing",
indicator == "indicator 6 # of children and youth benefiting from resilience enhancing programmes (MHPSS, DRR & Life Skills, etc)" ~
"6. Children resilience enhancing"
))
targets %>%
write_csv("./data/eie_targets.csv")
targets
targets <- read_excel("./data/5Ws_2023/Consolidated 5W_ Education_Mar 2023 Report.xlsx",
sheet = "Reach by Indicator",
skip = 1) %>%
clean_names() %>%
select(x1, x2,
contains("target")) %>%
setNames(c("county",
"county_overall_target",
"indicator1_target_children",
"indicator2_target",
"indicator3_target_people",
"indicator4_target",
"indicator5_target_educators",
"indicator6_target_children")) %>%
slice(0:23) %>%
separate(indicator2_target, into = c("indicator2_target_schools", "indicator2_target_children"), sep = "\\(") %>%
separate(indicator4_target, into = c("indicator4_target_schools", "indicator4_target_children"), sep = "\\(") %>%
mutate_at(vars(indicator2_target_schools,
indicator2_target_children,
indicator4_target_schools,
indicator4_target_children),
~ parse_number(.)) %>%
pivot_longer(cols = indicator1_target_children:indicator6_target_children,
names_to = "type",
values_to = "county_target") %>%
mutate(indicator_number = parse_number(type),
indicator = case_when(
str_detect(type, "1") ~ "number of children and youth accessing ECD spaces/schools in drought-affected areas",
str_detect(type, "2") ~ "number of schools/ECD spaces with feeding programmes",
str_detect(type, "3") ~ "number of learners and teachers with learning and teaching materials",
str_detect(type, "4") ~ "number of schools with adequate quantities of safe water for drinking and personal hygiene",
str_detect(type, "5") ~ "number of teachers/educaotrs trained on resilience-enhancing programmes",
str_detect(type, "6") ~ "number of children and youth benefiting from resiliece-enhancing programmes")) %>%
mutate(target_unit = str_sub(type, start = 19L)) %>%
select(county, indicator_number, indicator, county_target, target_unit, county_overall_target) %>%
mutate(indicator_short = case_when(
str_detect(indicator, "children and youth accessing ECD spaces") ~
"1. Access ECD spaces/schools",
str_detect(indicator, "feeding programmes") ~
"2. Feeding programmes",
# Not sure what's wrong with the text of this indicator
str_detect(indicator, "3") ~ "3. Teaching materials",
str_detect(indicator, "personal hygiene") ~
"4. Safe water, personal hygiene",
str_detect(indicator, "educators trained on resilience") ~
"5. Educators resilience enhancing",
str_detect(indicator, "children and youth benfiting from resilience") ~
"6. Children resilience enhancing"
))
targets %>%
write_csv("./data/eie_targets.csv")
eie %>%
filter(activity_status == "Completed") %>%
group_by(county, month, indicator_short) %>%
summarise(reach = sum(total_reached))
eie %>%
filter(activity_status == "Completed") %>%
group_by(county, month, indicator_short) %>%
summarise(reach = sum(total_reached)) %>%
pivot_wider(names_from = month, values_from = reach) %>%
right_join(targets %>%
select(county, county_target, indicator_short),
by = c("county", "indicator_short"))
eie %>%
filter(activity_status == "Completed") %>%
group_by(county, month, indicator_short) %>%
summarise(reach = sum(total_reached)) %>%
pivot_wider(names_from = month, values_from = reach) %>%
right_join(targets %>%
filter(!is.na(indicator_short)) %>%
select(county, county_target, indicator_short),
by = c("county", "indicator_short"))
eie %>%
filter(activity_status == "Completed") %>%
group_by(county, month, indicator_short) %>%
summarise(reach = sum(total_reached)) %>%
pivot_wider(names_from = month, values_from = reach) %>%
right_join(targets %>%
filter(!is.na(indicator_short)) %>%
select(county, county_target, indicator_short),
by = c("county", "indicator_short")) %>%
write_csv("reached_by_indicator_flat.csv")
